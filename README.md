# Fusion Type Annotations
Type annotations for the DaVinci Fusion Fuse API. Work in progress, and rather incomplete.

I also hope to expand to include type annotations for the Fusion/Resolve scripting API.

These types were largely generated by crudely parsing Roger Magnusson's [Fuse reference](https://github.com/EmberLightVFX/Fusion-Script-Docs). There are likely errors and incomplete definitions.

*Disclaimer: I am not a Lua developer, a Fusion expert, and I've never done anything like this before! Expect blunders.*

## Current Limitations

### Attribute-defined types

The types do not capture the relationship between attribute tables passed during instantiation and the resulting types.

For example, with Fuse Input/Output objects, the type is defined in the attribute table passed during instantiation:

```lua
    InImage = self:AddInput("Input", "Input", {
        LINKID_DataType = "Image", -- Defines the input type
        LINK_Main = 1,
        INP_Required = true
    })

    OutImage = self:AddOutput("Output", "Output", {
        LINKID_DataType = "Image", -- Defines the output type
        LINK_Main = 1,
    })
```

The type of the object returned by `InImage:GetValue(req)` is defined by the `LINKID_DataType` attribute, but the type system does not know this and instead types it as `Parameter`.

This can be solved with generic types, but I haven't implemented them yet.

### Missing types

While Roger's reference does a great job documenting most of the Fuse API, there are still some rather important types which are not included.

This seems limited to a handful of global types available by default in the context of a Fuse, such as `bmd`, `app`, etc.

I've manually added a minimal `Fuse` type to ensure references to `self` are typed, but there is a lot of missing context which needs to be fleshed out.